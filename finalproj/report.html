<html>
    <style>
    body {
        background-color: white;
        padding: 100px;
        width: 1000px;
        margin: auto;
        text-align: left;
        font-weight: 300;
        font-family: 'Open Sans', sans-serif;
        color: #121212;
    }
    h1, h2, h3, h4 {
        font-family: 'Source Sans Pro', sans-serif;
    }
    kbd {
        color: #121212;
    }
    </style>

    <header>
      <title>CS184 Spring 2023 Final Project - Black Hole Ray Marcher</title>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script id="MathJax-script" async
              src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
      </script>
    </header>

    <body>
        <!-- <div align = "middle">
            <img src = "" width = 800px height = 400px>
        </div> -->
        <div align="middle">
            <h2>CS184 Spring 2023 Final Project</h2>
            <h1>Final Report: Black Hole Ray Marcher </h1>
            <h4>Team Members: Grace Chen, Jerry Zhang, Mingyang Wang, Irene Geng</h4>
        </div>
        <div align="middle">
            <table style="width:100%">
              <tr align="center">
                <td>
                  <img src="final_images/texture_3_bh.png" align="right" width="400px"/>
                </td>
                <td>
                  <img src="final_images/texture_2_bh.png" align="left" width="400px"/>
                </td>
              </tr>
              <tr align="center">
                <td>
                  <img src="final_images/texture_1_bh.png" align="right" width="400px"/>
                </td>
                <td>
                  <img src="final_images/texture_1_bh_zoom.png" align="left" width="400px"/>
                </td>
              </tr>
            </table>
        </div>
        <br>
        
        <div>
            <h2> Abstract </h2>
            <div>
                <p> 
                    In most graphics applications, we assume that light travels in a perfectly straight line. While this is a safe assumption in most scenarios, this is not always the case. 
                </p>
                <p> 
                    A black hole is an extremely dense object in space with a gravitational pull so strong that it prevents anything, including light, from escaping once it gets too close. Einstein’s theory of general relativity describes gravity as the result of curvature of spacetime; when light travels through curved spacetime generated by black holes (or other very massive objects), the light’s behavior becomes warped and bends around the black hole.                
                </p>
                <p>
                    In this project, we use ray marching methods to render a realistic black hole. We first present a Cartesian coordinate method to render a Schwarzschild black hole (non-rotating, spherically symmetric), and then transition to Boyer-Lindquist coordinates to generalize renderings to a Kerr black hole (rotating, potentially asymmetric). We apply various texture mappings onto the black hole’s accretion disk and starfield background as well as a bloom filter to create the final output renders.
                </p>

                <p> See link to our 
                    <a href="https://docs.google.com/presentation/d/1_prJLe6kyc7dSLX8dIAgGah_qeH1JckdDUp0xO9Doh8/edit#slide=id.p"> Presentation Slides</a>
                </p>
                <p> See link to our <a href=""> Final Video </a></p>
                
            </div>
            
        </div>
        <br>
        <div>
            <h2> Technical Approach </h2>
            <h3> Preface: Setup and Physics Overview  </h3>
            <div>
                <p>
                  The black holes that we consider can be entirely described by their mass and angular momentum; all other relevant properties may be calculated deterministically from these two properties. Every black hole has a Schwarzschild radius, which is defined as: \($$r_s = 2GM / c^2$$)
                </p>
                <p>
                    We define our coordinate systems such that the black hole is centered at the origin. As is typical practice in theoretical physics, parameters are normalized such that the mass of the black hole , Gravitational Constant , and speed of light  are set to 1. As a result, all distances are (implicitly) measured in units of the black hole’s Schwarzschild radius. We point the camera directly at the black hole such that the black hole is centered in its field of view.
                </p>
                <div align="middle">
                    <table style="width:100%">
                    <tr align="center">
                        <td>
                        <img src="physics/photons.png" align="middle" width="400px"/>
                        <figcaption></figcaption>
                        </td>
                        
                    </tr>
                    </table>
                </div>
                <p> The above diagram (stolen from google, somewhere) shows several photon trajectories as they travel past the black hole. Any ray that travels close enough to the black hole and crosses the event horizon (the black circle, with radius equal to rs ) becomes trapped, forming the black hole’s “shadow.” Rays outside of this threshold are bent around and may orbit, but do not get trapped in, the black hole. Note that light can orbit multiple times around the black hole, as is the case with one of the purple rays.</p>
                <div align="middle">
                    <table style="width:100%">
                    <tr align="center">
                        <td>
                        <img src="physics/diagram.png" align="middle" width="800px"/>
                        <figcaption></figcaption>
                        </td>
                        
                    </tr>
                    </table>
                </div>
                <p> 
                    The above diagram demonstrates some of the behavior we expect to see when rendering black holes. At the center, we see the Black Hole Shadow, surrounded by a bright photon ring. The photon ring is a region where the black hole’s gravity forces photons into orbits around the event horizon. The Accretion Disk, despite being modeled as a perfectly flat disk, appears above and below the shadow due to light rays curving around the black hole.
                </p>
                <p>
                    The Einstein Ring, represented as the dotted white circle, is the point(s) at which all light rays are perfectly bent such that they hit the same object, creating “rings” of distortion. Objects visible outside of the Einstein Ring have secondary images reflected on the opposite side of the black hole inside the Einstein Ring, such as shown in the two orange circles and the two yellow circles.

                </p>
                <p>
                    The exact mechanisms for studying and tracing light paths in the presence of a black hole require a much deeper study of (and probably a PhD in) theoretical physics, and is quite out of scope for the purposes of this project (especially since our group is lacking in both physics knowledge and PhDs). Below, we present two different approaches for rendering black holes. The first is a (relatively) crude approximation: a simple ray marcher that uses Cartesian coordinates and Forward Euler integration to render Schwarzschild black holes. Then, we build a more physically accurate, generalizable representation using Boyer-Lindquist coordinates and Cash-Karp numerical integration to render either Schwarzschild or Kerr black holes.

                </p>

                
            </div>

            <h3> Initial Approach: Schwarzschild</h3>
            <div>
                <h4> Overview: Ray Marching</h4>
                <div>
                    <p> 
                        A Schwarzschild black hole is a simple model for a perfectly symmetric, spherical black hole that has zero charge and zero angular momentum. These assumptions provide a simpler and more well-understood model for light behavior.
                    </p>
                    <p>
                        Because light rays do not travel in straight paths around a black hole, we can no longer use traditional ray tracing line intersection tests to check for intersections. Instead, we use ray marching, a technique that simulates the (non-linear) path of a light ray by taking small steps through a scene, updating ray parameters where necessary, and computing intersections with the objects the ray encounters along the way.
                    </p>
                    <p> 
                        At any position, we approximate the ray’s acceleration due to gravity with:
                    </p>
                    <p>
                        where  is defined as the magnitude of the ray’s specific angular momentum, a constant value calculated once per ray, and  is defined as the vector pointing from the center of the sphere to the photon’s current position. See Appendix A for details and derivations.
                    </p>
                </div>

                <h4> Forward Euler Integration</h4>
                <div>
                    <p>
                        With this acceleration, we can then march rays “backwards” in time using Forward Euler integration, updating the photon’s position and velocity at each time step. 

                    </p>
                    
                    <p>
                        Since our black hole is represented by a sphere centered at the origin, we can test whether a ray has intersected the black hole with the standard geometric ray-sphere intersection between prev_position and curr_position of each ray marching timestep. This yields the following result:
                    </p>
                    <div align="middle">
                        <table style="width:100%">
                        <tr align="center">
                            <td>
                            <img src="schwarzchild/ray_tracing.png" align="middle" width="400px"/>
                            <figcaption>Standard Ray Tracing: Sphere with Debug Coloring</figcaption>
                            </td>
                            <td>
                            <img src="schwarzchild/ray_marching.png" align="middle" width="400px"/>
                            <figcaption>Ray Marching: "Black Hole" with Debug Coloring</figcaption>
                            </td>
                        </tr>
                        </table>
                    </div>
                    <p> 
                        <i>
                            Notable Observations: Since light rays are bent toward the sphere/black hole, the image of the sphere appears bigger as a result. Additionally, this bending of light enables us to see the entire surface of the sphere – we can see colors from the back side of the sphere (yellow and green) along the edges of the image!
                        </i>

                    </p>
                    <p>
                        We represent the black hole’s accretion disk as a perfectly flat disk with a normal vector (corresponding to the disk’s plane), inner radius, and outer radius (the shape of a 2D donut). Similar to the black hole, we conduct ray-plane intersection at every ray marching timestep; if it intersects the accretion disk plane, we know that the ray intersects the accretion disk itself if the intersection point’s distance from the origin is between the inner and outer radius of the accretion disk.

                    </p>
                    <p>
                        If the ray has not intersected either the sphere or the accretion disk after taking the maximum number of steps, or the ray travels a sufficiently large distance away from the black hole (ie  , we conclude that the ray escapes to infinity; in the physical model, this corresponds to the ray originating from the background (aka the celestial sphere).
                    </p>
                    <p>
                        Additionally, we implement texture mapping for the black hole surface, accretion disk, and background for debugging as well as preparation for rendering realistic accretion disks and starfield backgrounds. Mapping checkerboard grid patterns provide a helpful visualization for the behavior of light in our render:
                    </p>
                    <div align="middle">
                        <table style="width:100%">
                        <tr align="center">
                            <td>
                            <img src="schwarzchild/ray_tracing_checker.png" align="middle" width="400px"/>
                            <figcaption>Standard Ray Tracing </figcaption>
                            </td>
                            <td>
                            <img src="schwarzchild/ray_marching_checker.png" align="middle" width="400px"/>
                            <figcaption>Ray Marching</figcaption>
                            </td>
                        </tr>
                        </table>
                    </div>
                    <p>
                        <i>
                            Notable Observations: The accretion disk is represented as a 2D disk, but light curving over/under the black hole causes it to appear in front, on top of, and underneath the black hole. The horizontal red line in the background is distorted and bends over the black hole, while a secondary image is produced below the black hole. Similarly to the previous example, we can see the entirety of the black hole surface, resulting in a denser (blue/white) checkerboard pattern.
                        </i>
                    </p>
                    <p>
                        Below, we show two images with proper accretion disk and starfield textures rendered with the above method:

                    </p>
                    <div align="middle">
                        <table style="width:100%">
                        <tr align="center">
                            <td>
                                <img src="schwarzchild/schwarzchild_1.png" align="middle" width="400px"/>
                            </td>
                            <td>
                                <img src="schwarzchild/schwarzchild_2.png" align="middle" width="400px"/>
                            </td>
                        </tr>
                        </table>
                    </div>
                </div>
                
            </div>

            <h3> Second Approach: Kerr Black Hole</h3>
            <div>
                <h4> Overview/Limitations of the previous approach</h4>
                <div>
                    <p>
                        A Kerr black hole is a more complex model for a black hole that has non-zero angular momentum (but still zero charge). Unfortuantely, the curvature of black hole spacetime means that they cannot be easily or properly represented by Cartesian coordinates. To better account for the physical effects of the black hole's rotation, we instead use Boyer-Lindquist coordinates, a type of coordinate system used in the theory of general relativity to describe the geometry of spacetime around any rotating massive object (like black holes).

                    </p>
                    <p>
                        Additionally, the Forward Euler Integration method used in the previous section is potentially unstable and ill-defined. The previous renders required very small step sizes, causing renders to be slow and inefficient. Moreover, moving the camera position far away would sometimes cause our rays to skip portions of or the entire black hole/accretion disk. For example, in the image below, we observe a hole in the center of the black hole:

                    </p>
                    <div align="middle">
                        <table style="width:100%">
                        <tr align="center">
                            <td>
                                <img src="kerr/kerr_limitations.png" align="middle" width="400px"/>
                            </td>
                        </tr>
                        </table>
                    </div>
                    <p>
                        The methods defined below aim to solve these issues.
                    </p>
                </div>

                <h4>Improvments: Boyer-Lindquist</h4>
                <div>
                    <p>
                        Boyer-Lindquist Coordinates consist of 4 components: . The first 3 coordinates, , are oblate spherical coordinates. Like in the Schwarzschild case, these coordinates are typically normalized such that the black hole radius is 1. We also have a -coordinate, which marks the time of an event relative to a distant, unmoving observer. This coordinate system allows us to take into account the asymmetric effect of a black hole’s rotation on spacetime curvature.
                    </p>
                    <p> Boyer-Lindquist Coordinates can be converted into Cartesian coordinates via:

                        <ul>
                            <li>

                            </li>
                            <li>

                            </li>
                            <li>

                            </li>
                        </ul>
                    </p>
                    <p> The Kerr metric describes the geometry of spacetime around a black hole of mass M and angular momentum J. In Boyer-Lindquist coordinates, distance (the line element) is defined by:

                        <ul>
                            <li>

                            </li>
                            <li>

                            </li>
                            <li>
                                
                            </li>
                            <li>
                                
                            </li>
                            <li>
                                
                            </li>
                        </ul>
                    </p>
                    <p>
                        Around a Kerr black hole, a photon follows a null geodesic path, the shortest distance path between two points in curved spacetime. This can be determined by solving a system of differential equations, shown in the table below, where derivatives are taken with respect to propertime 𝜏. is the ray’s four-momentum, a generalization of three-dimensional momentum to spacetime. As a convenient convention, we set the ray’s conserved energy, . 
                    </p>
                </div>

                <h4>Improvements: Cash-Karp Method</h4>
                <div>
                    <p> Our ray marching approach for Kerr black holes uses the Cash-Karp method, a fifth-order Runge-Kutta method with an adaptive step size. Cash-Karp is particularly efficient for ODEs with rapidly changing behavior by decreasing step sizes when the solution changes rapidly (such as when we are closer to the black hole), increasing accuracy as well as efficiency.
                    </p>
                    <p>
                        At each timestep, we integrate forward via Cash-Karp and update our ray’s null geodesic properties. A more complete description of this process is described in Appendix B. Like in our first approach, we perform the following ray-intersection tests:

                    </p>
                    <ol>
                        <li>
                            If we find that the ray’s r-coordinate is less than the black hole’s event horizon radius, we know that the ray has fallen into the black hole.
                        </li>
                        <li>
                            Our accretion disk intersection test remains similar to our first approach; we check if the ray has intersected the accretion disk plane between the disk’s inner and outer radius.
                        </li>
                        <li>
                            If the ray’s r-coordinate is greater than the camera’s r-coordinate, or if we have exceeded the max number of steps without intersecting anything, we assume that the ray has escaped to infinity (and map it to a background starfield texture).
                        </li>
                    </ol>
                </div>

                <h4>Improvments: Texture Mapping of Background and Accretion Disk</h4>
                <div>
                    <p>
                        For a more realistic accretion disk, we asked an artist friend to create an accretion disk texture for us, pictured here:

                    </p>
                    <div align="middle">
                        <table style="width:100%">
                        <tr align="center">
                            <td>
                            <img src="alpha_channel/george.png" align="middle" width="400px"/>
                            <figcaption> Credit: George Geng</figcaption>
                            </td>
                        </tr>
                        </table>
                    </div>

                    <p> Our custom accretion disk texture includes an alpha-channel, which we use to create semi-transparent feathering of the accretion disk. When a ray intersects the accretion disk during ray-marching, instead of terminating the ray, we march the ray through the accretion disk to also obtain the color of the black hole/background intersection(s) behind it. Then, we linearly interpolate the color of the accretion disk and future intersections with the accretion’s alpha value to achieve the partially transparent effect. </p>
                    
                    <div align="middle">
                        <table style="width:100%">
                        <tr align="center">
                            <td>
                            <img src="alpha_channel/no_alpha.png" align="middle" width="400px"/>
                            <figcaption>Fully Opaque Accretion Disk</figcaption>
                            </td>
                            <td>
                            <img src="alpha_channel/alpha.png" align="middle" width="400px"/>
                            <figcaption>Semi-transparent Accretion Disk</figcaption>
                            </td>
                        </tr>
                        </table>
                    </div>
                </div>

                <h4>Improvements: Bloom Filter Effect</h4>
                <div>
                    <p> As a post-processing effect, we apply a bloom filter to simulate camera lens flare and brighter intensity of the accretion disk. Bloom also creates a glowing effect where the light of the accretion disk appears to bleed over the edges. After the ray-marching process, we take a square Gaussian kernel and convolve it with each of the pixel colors that belong to the accretion disk. We add this output back to the frame buffer before writing out an image file.</p>
                    <div align="middle">
                        <table style="width:100%">
                    
                        <tr align="center">
                            <td>
                              <img src="bloom/kerr_0.6_500_nobg_nobloom.png" align="middle" width="400px"/>
                              <figcaption> No Bloom</figcaption>
                            </td>
                            <td>
                              <img src="bloom/kerr_0.6_500_nobg_bloom_41_13_8.png" align="middle" width="400px"/>
                              <figcaption> Some Bloom </figcaption>
                            </td>
                        </tr>
                        <tr align="center">
                            <td>
                              <img src="bloom/kerr_0.6_500_nobg_bloom_41_41.png" align="middle" width="400px"/>
                              <figcaption> More Bloom</figcaption>
                            </td>
                            <td>
                              <img src="bloom/kerr_0.6_500_nobg_bloom_41_57_1.png" align="middle" width="400px"/>
                              <figcaption>Too Much Bloom</figcaption>
                            </td>
                          </tr>
                          <tr align="center">
                            <td>
                              <img src="bloom/bloom_star.png" align="middle" width="400px"/>
                              <figcaption>Bloom with Starfield</figcaption>
                            </td>
                            <td>
                                <img src="bloom/bloom_star2.png" align="middle" width="400px"/>
                                <figcaption>Bloom with Starfield</figcaption>
                            </td>
                          </tr>
                        </table>
                    </div>
                </div>

                <h4>[Attempted] Improvments: Early Ray Termination Optimization</h4>
                <div>
                    <p>
                        This paper describes the rendering methods used by DNEG to produce the images of a spinning black hole in the movie Interstellar. Before marching a ray, DNEG uses an early ray termination algorithm that calculates whether or not the ray originates from the black hole’s event horizon; if it does, the ray does not need to be considered further. DNEG only performs numerical integration for rays that originate from the accretion disk or the celestial sphere/starfield background.
                    </p>
                    <p>
                        We attempted this, but ran into some mathematical bugs that we were unable to resolve in time. Our implementation just integrates all rays, which is slower but should yield similar results. Heavy optimization on our end is less necessary since we did not attempt to create large-scale animations.
                    </p>
                </div>
            </div>

            <h3> Problems Encountered and Lesson Learned</h3>
            <div>
                <p>
                    Throughout this project, one of the difficulties we encountered were surrounding the technical approaches of our blackhole implementation. It was difficult to understand physics formulas presented in the paper and parse the heavy mathematical explanations for the existing blackhole models we read about in the references. 

                </p>
                <p>
                    We also spend some time understanding the starter code provided by project 3 and project 4. Previously, we treated a lot of the code provided in the starter code as a black box and this project gave us an opportunity to explore how the ray tracing and simulation systems were set up. Based on these new understanding and familiarity, we made many design decisions for this project of rendering blackholes. 
                </p>
                <p>
                    Through this project, we gained some insights into the nuanced differences between various blackhole models and the ray marching algorithm. Overall, we learned a lot through researching, implementing, and exploring!

                </p>
                <p>
                    Lessons learned: this entire project was one large bug. Haha 

                </p>
            </div>
        </div>
        <div>
            <h2> Final Results </h2>

            <h3> Varing Inclination Angle</h3>
            <div align="middle">
                <table style="width:100%">
                <tr align="center">
                    <td>
                    <img src="inclination_gif/check_incline_sim_full.gif" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                    <td>
                    <img src="inclination_gif/text_incline_sim_full.gif" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                </tr>
                </table>
            </div>

            <h3> Varing Angular Momentum</h3>
            <div align="middle">
                <table style="width:100%">
                <tr align="center">
                    <td>
                    <img src="angular_momentum_gif/check_a_sim_full.gif" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                    <td>
                    <img src="angular_momentum_gif/text_a_sim_full.gif" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                </tr>
                </table>
            </div>

            <h3> Starfield Accretion Texture Mapping Results</h3>

            <div align="middle">
                <table style="width:100%">
                <tr align="center">
                    <td>
                    <img src="final_images/5.png" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                    <td>
                    <img src="final_images/text_5.png" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                    <img src="final_images/3.png" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                    <td>
                    <img src="final_images/text_3.png" align="middle" width="400px"/>
                    <figcaption></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="final_images/2.png" align="middle" width="400px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="final_images/text_2.png" align="middle" width="400px"/>
                        <figcaption></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="final_images/1.png" align="middle" width="400px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="final_images/text_1.png" align="middle" width="400px"/>
                        <figcaption></figcaption>
                    </td>
                </tr>
                </table>
            </div>
        </div>    

        <div>
            <h2> References </h2>
            <ul>
                <li>
                    Interstellar paper: 
                    <a href= "https://iopscience.iop.org/article/10.1088/0264-9381/32/6/065001/pdf">
                        https://iopscience.iop.org/article/10.1088/0264-9381/32/6/065001/pdf 
                    </a>
                </li>
                <li>
                    Bloom shader filter: <a href = " https://learnopengl.com/Advanced-Lighting/Bloom">
                        https://learnopengl.com/Advanced-Lighting/Bloom
                    </a>
                </li>
                <li> Reference 1: <a href = "https://rantonels.github.io/starless/">https://rantonels.github.io/starless/</a></li>
                <li>
                    Reference 2: <a href = "http://locklessinc.com/articles/raytracing/">http://locklessinc.com/articles/raytracing/</a>
                </li>
                <li>
                    Reference 3: <a href = "https://www.codeproject.com/Articles/994466/Ray-Tracing-a-Black-Hole-in-Csharp">
                        https://www.codeproject.com/Articles/994466/Ray-Tracing-a-Black-Hole-in-Csharp
                    </a>                    
                </li>
                <li>
                    Kerr Metric: <a href = "https://en.wikipedia.org/wiki/Kerr_metric">
                        https://en.wikipedia.org/wiki/Kerr_metric
                    </a>
                </li>
                <li>
                    Boyer-Lindquist: <a href = "https://en.wikipedia.org/wiki/Boyer–Lindquist_coordinates">
                        https://en.wikipedia.org/wiki/Boyer–Lindquist_coordinates
                    </a>
                </li>
                <li>
                    Cash-Karp method: <a href = "https://en.wikipedia.org/wiki/Cash–Karp_method">
                        https://en.wikipedia.org/wiki/Cash–Karp_method
                    </a>
                </li>
                <li>
                    Runge-Kutta method: <a href = "https://en.wikipedia.org/wiki/Runge–Kutta_methods">
                        https://en.wikipedia.org/wiki/Runge–Kutta_methods
                    </a>
                </li>
            </ul>
        </div> 

        <div>
            <h2> Team Contributions </h2>
            
        </div> 

        <div> 

            <h2>Bug Art Gallery</h2>
            <div align="middle">
                <table style="width:100%">
                <tr align="center">
                    <td>
                        <img src="bug_art/image1.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image10.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image15.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image13.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="bug_art/image18.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image14.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image9.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image16.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <img src="bug_art/image7.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image4.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image5.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                    <td>
                        <img src="bug_art/image3.png" align="middle" width="200px"/>
                        <figcaption></figcaption>
                    </td>
                </tr>
                </table>
            </div>

            <div>
                <h2> Appendix</h2>
                <h3> A: the acceleration derivation </h3>

                <h3> B: Cash-Karp Integration </h3>
            </div>
            
        
        </div>


        <!-- <div align="middle">
            <table style="width:100%">
              <tr align="center">
                <td>
                  <img src="" align="middle" width="400px"/>
                  <figcaption></figcaption>
                </td>
                <td>
                  <img src="" align="middle" width="400px"/>
                  <figcaption></figcaption>
                </td>
              </tr>
              <tr align="center">
                <td>
                  <img src="" align="middle" width="400px"/>
                  <figcaption></figcaption>
                </td>
                <td>
                  <img src="" align="middle" width="400px"/>
                  <figcaption></figcaption>
                </td>
              </tr>
              <tr align="center">
                <td>
                  <img src="" align="middle" width="400px"/>
                  <figcaption></figcaption>
                </td>
                <td>
                    <img src="" align="middle" width="400px"/>
                    <figcaption></figcaption>
                </td>
              </tr>
            </table>
        </div> -->

        </div>
        <br>
        <div>
           
        </div>
    </body>
</html>